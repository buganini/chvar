<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<style type="text/css">
.hl{
	border: solid 1px #f00;
}
.red{
	color:#f00;
}
td{
	border: solid 1px #777;
	text-align: center;
	width: 4em;
}
img,a{
	vertical-align:middle;
}
</style>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript">
function doKeyDown(ev){
	if(navigator.userAgent.match("Gecko")){
		kc=ev.which;
	}else{
		kc=ev.keyCode;
	}
	if (ev.ctrlKey && kc == 13){
		addgrp();
		return false;
	}
} 

function getinfo(){
	if(lc!=$('#text').val()){
		lc=$('#text').val();
		html=$.post('engine.php',{
			action: 'info',
			text: lc
		},function(t){$('#glyph').html(t);},"html");
	}
	showrelated();
}

function showrelated(){
		html=$.post('engine.php',{
			action: 'related',
			level: $('#level').val(),
			text: lc
		},function(t){$('#related').html(t); nid=0;},"html");
}

function showinfo(s){
	html=$.post('engine.php',{
		level: $('#level').val(),
		action: 'info',
		text: s
	},function(t){$('#info').html(t);},"html");
}

function update(dat){
	dat=eval(dat);
	if(dat.length==0){
		return;
	}
}

function addgrp(){
	$.post('engine.php',{
		action: 'addgrp',
		id: nid,
		level: $('#level').val(),
		text: $('#text').val(),
	},update,"json");
	showrelated();
}
</script>
</head>
<body onkeydown="doKeyDown(event)">
<select id="level">
<option value="1">Equivalent</option>
<option value="2">Borrow</option>
<option value="3">Mistake</option>
</select><br />
<textarea id="text" onKeyup="getinfo()"></textarea>
<input type="button" value="Submit" onClick="addgrp()" />
<div id="glyph"></div>
<hr />
<div id="info" style="position:fixed; right:0;"></div>
<div id="related">
</div>
<script type="text/javascript">
	lc='';
	nid=0;
</script>
</body>
</html>
